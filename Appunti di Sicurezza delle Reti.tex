%% LyX 2.3.2 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\RequirePackage{fix-cm}
\documentclass[12pt,italian]{amsbook}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage[a4paper]{geometry}
\geometry{verbose,tmargin=2cm,bmargin=2.2cm,lmargin=2cm,rmargin=4cm,headheight=2cm,headsep=1cm,footskip=1cm}
\setlength{\parskip}{\smallskipamount}
\setlength{\parindent}{0pt}
\usepackage{babel}
\usepackage{varioref}
\usepackage{refstyle}
\usepackage{units}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{amsbsy}
\usepackage{amstext}
\usepackage{amsthm}
\usepackage{amssymb}
\makeindex
\usepackage{graphicx}
\usepackage{wasysym}
\PassOptionsToPackage{normalem}{ulem}
\usepackage{ulem}
\usepackage[unicode=true,
 bookmarks=true,bookmarksnumbered=true,bookmarksopen=true,bookmarksopenlevel=1,
 breaklinks=false,pdfborder={0 0 0},pdfborderstyle={},backref=page,colorlinks=false]
 {hyperref}
\hypersetup{pdftitle={Appunti di Fondamenti di fondamenti di Automatica},
 pdfauthor={Lorenzo Prosseda},
 pdfsubject={Corso di fondamenti di Automatica del prof. Fagiano, Politecnico di Milano 2017-2018},
 pdfkeywords={automatica}}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.

\AtBeginDocument{\providecommand\secref[1]{\ref{sec:#1}}}
\newcommand{\noun}[1]{\textsc{#1}}
\RS@ifundefined{subsecref}
  {\newref{subsec}{name = \RSsectxt}}
  {}
\RS@ifundefined{thmref}
  {\def\RSthmtxt{theorem~}\newref{thm}{name = \RSthmtxt}}
  {}
\RS@ifundefined{lemref}
  {\def\RSlemtxt{lemma~}\newref{lem}{name = \RSlemtxt}}
  {}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\numberwithin{section}{chapter}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}
\theoremstyle{plain}
    \ifx\thechapter\undefined
	    \newtheorem{thm}{\protect\theoremname}
	  \else
      \newtheorem{thm}{\protect\theoremname}[chapter]
    \fi
\theoremstyle{definition}
    \ifx\thechapter\undefined
      \newtheorem{example}{\protect\examplename}
    \else
      \newtheorem{example}{\protect\examplename}[chapter]
    \fi
\theoremstyle{plain}
    \ifx\thechapter\undefined
      \newtheorem{prop}{\protect\propositionname}
    \else
      \newtheorem{prop}{\protect\propositionname}[chapter]
    \fi
\theoremstyle{remark}
    \ifx\thechapter\undefined
      \newtheorem{rem}{\protect\remarkname}
    \else
      \newtheorem{rem}{\protect\remarkname}[chapter]
    \fi
\theoremstyle{plain}
    \ifx\thechapter\undefined
  \newtheorem{cor}{\protect\corollaryname}
\else
      \newtheorem{cor}{\protect\corollaryname}[chapter]
    \fi
\theoremstyle{definition}
    \ifx\thechapter\undefined
      \newtheorem{xca}{\protect\exercisename}
    \else
      \newtheorem{xca}{\protect\exercisename}[chapter]
    \fi
\theoremstyle{definition}
    \ifx\thechapter\undefined
      \newtheorem{sol}{\protect\solutionname}
    \else
      \newtheorem{sol}{\protect\solutionname}[chapter]
    \fi

\@ifundefined{date}{}{\date{}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{pgfplots}
\usepackage{caption}
\captionsetup{font=scriptsize,labelfont=scriptsize}
\usepackage{geometry}
\usepackage{marginnote}
\usepackage{imakeidx}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{hyphenat}

\renewcommand{\marginpar}[1]{\marginnote{\footnotesize #1}}
\setlength\marginparsep{0.3cm}
\setlength\marginparwidth{3cm}
\newcommand\xqed[1]{%
  \leavevmode\unskip\penalty9999 \hbox{}\nobreak\hfill
  \quad\hbox{#1}}
\newcommand\demo{\xqed{$\square$}}
\newcommand\sln[1]{\xqed{$\scriptstyle Sol.\,#1$}}
\makeindex

\makeatother

\providecommand{\corollaryname}{Corollario}
\providecommand{\examplename}{Esempio}
\providecommand{\exercisename}{Esercizio}
\providecommand{\propositionname}{Proposizione}
\providecommand{\remarkname}{Osservazione}
\providecommand{\solutionname}{Soluzione}
\providecommand{\theoremname}{Teorema}

\begin{document}
\newgeometry{margin=1cm}
\title{Appunti di Sicurezza delle reti}
\author{Lorenzo Prosseda, a.a. 2018-2019}
\dedicatory{
\begin{figure}[!h]
\vspace{20cm}
\includegraphics{/home/l3r0/Documenti/Polimi/Automatica/Illustrazioni/gfdl-logo}
\end{figure}
Copyright \textcopyright 2019 Lorenzo Prosseda. Permission is granted
to copy, distribute and/or modify this document under the terms of
the GNU Free Documentation License, Version 1.3 or any later version
published by the Free Software Foundation; with no Invariant Sections,
no Front-Cover Texts, and no Back-Cover Texts. A copy of the license
is included in the file called \textquotedbl LICENSE\textquotedbl .}

\maketitle
\restoregeometry

\tableofcontents{}

\global\long\def\lm#1#2#3{\underset{{\scriptstyle #1\rightarrow#2}}{\lim}#3}%

\global\long\def\serie#1#2#3{\overset{{\scriptstyle #2}}{\underset{{\scriptstyle #1}}{\sum}}#3}%

\global\long\def\somme#1#2#3#4{\underset{{\scriptstyle #1}}{\overset{{\scriptstyle #2}}{\int}}#3d#4}%

\global\long\def\mcd#1#2{\mathrm{{\scriptstyle MCD}}\left(#1,\,#2\right)}%

\global\long\def\cgm#1#2#3{#1\equiv#2\left(\text{mod}\,#3\right)}%

\global\long\def\ncgm#1#2#3{#1\not\equiv#2\left(\text{mod}\,#3\right)}%

\global\long\def\mod#1#2{#1\,\text{mod}\,#2}%

\global\long\def\ord#1{\mathrm{{\scriptstyle ORD}}\left(#1\right)}%

\global\long\def\tc{\,:\,}%


\part{Crittografia}

\chapter{Teoria dei numeri}

\section{Proprietà degli interi}

Da ora in avanti parleremo di numeri interi, positivi o negativi,
operando all'interno dell'insieme $\mathbb{Z}$; enunciamo la proprietà
di divisione nel modo seguente: presi due interi $a,\,b\in\mathbb{Z}$
non uguali ($a\neq b$) si dice che $a$ divide $b$ quando $a$ è
un divisore di $b$, ovvero
\[
a\backslash b\implies\exists k\tc b=k\cdot a
\]

Dalla precedente deduciamo che $b$ dovrà essere un multiplo di $a$.
Inoltre, otteniamo anche che:
\[
\forall a\in\mathbb{Z}\,:\,a\backslash0;\;\nexists a\in\mathbb{Z}\tc0\backslash a;\;\forall a\in\mathbb{Z}\,:\,a\backslash a
\]

La relazione di divisione introdotta ammette la proprietà transitiva:
\[
\forall a,b,c\in\mathbb{Z}\,\land\,a\neq b\neq c\tc a\backslash b\,\land\,b\backslash c\implies a\backslash c
\]


\section{Numeri primi}

\subsection{Definizione e proprietà}

Un numero $a$ si dice primo quando è divisibile solo per 1 e per
sé stesso (ovvero se vale $\forall b\in\mathbb{Z}\tc b\backslash a\iff b=1\,\lor\,b=a$);
un numero composto è scomponibile in un numero finito di fattori,
e questa scomposizione è unica. Determinare la primalità di un numero
tuttavia non è cosa facile; introduciamo il seguente teorema:
\begin{thm}
Sia $\pi\left(n\right)\coloneqq$``numero di numeri primi fino a
$n$'', allora vale\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Teorema dei numeri primi}{\footnotesize{}\index{Numeri primi, teorema@{\footnotesize{}Numeri primi, teorema}}\label{thm:Numeri-primi}}}[0.1cm]
\[
\pi\left(n\right)\sim\dfrac{n}{\ln\left(n\right)}
\]
\end{thm}
Alcuni algoritmi crittografici usano i numeri primi come ``ingredienti''
per creare le chiavi: in questi casi il teorema introdotto si dimostra
molto utile per determinare la quantità di numeri primi che è possibile
ottenere con una data quantità di cifre.
\begin{example}
Determinare una stima della quantità di numeri primi che è possibile
ottenere a partire da 100 cifre.

$\checked$Usando il Teorema \ref{thm:Numeri-primi} possiamo scrivere
la quantità di numeri primi con 100 cifre come
\[
\pi\left(10^{100}\right)-\pi\left(10^{99}\right)=\frac{10^{100}}{100\ln\left(10\right)}-\frac{10^{99}}{99\ln\left(10\right)}\simeq\boxed{10^{97}}
\]
\demo
\end{example}
Se fossimo nel contesto di un algoritmo di cifratura, pur sapendo
che la chiave sia un numero primo di 100 cifre, dovremmo analizzare
in ogni caso $10^{97}$ possibili candidati.

Prendiamo\marginpar{La funzione $\protect\mcd ab$ indica il massimo comune divisore tra
$a$ e $b$} ora $a,\,b\in\mathbb{Z}$ tali che $\mcd ab=1$: in tal caso diremo
che $e$ e $b$ sono \emph{coprimi} o \emph{primi relativi}, indicando
la loro relazione come $a\perp b$; da questa relazione segue che
due numeri coprimi non hanno fattori in comune.

Escluso il numero 2, tutti i primi sono dispari, e sono divisi in
due classi: preso un numero primo $p$, esso appartiene a una delle
seguenti classi:
\begin{itemize}
\item $\cgm p14$
\item $\cgm p34$
\end{itemize}
L'operatore $\equiv$ indica la congruenza in modulo: si dice che
un numero $a\in\mathbb{Z}$ è \emph{congruente a 1 modulo $n$} (e
si scrive $\cgm a1n$) se il resto della divisione di $a$ per $n$
è 1.

Componendo le due classi osserviamo che tutti i numeri primi $p$
possono essere indicati come 
\begin{equation}
p=6k\pm1\implies\cgm p{\pm1}6,\,k\in\mathbb{Z}\label{eq:Successione-primi-classi}
\end{equation}
Troveremo per esempio $p_{k=1}=6\pm1=\left\{ 5,\,7\right\} ,\,p_{k=2}=12\pm1=\left\{ 11,\,13\right\} ,\,p_{k=3}=18\pm1=\left\{ 17,\,19\right\} ,\,\ldots\,$;
osserviamo che tutti i numeri della successione appena definita sono
primi, tuttavia non tutti i primi appartengono a questa successione.

\subsection{Test di primalità con classi}

Possiamo usare la successione (\ref{eq:Successione-primi-classi})
per testare la primalità di un numero intero: sia $n>0$ un numero
del quale si vuole conoscere la primalità; allora definiamo un algoritmo
iterativo che costruisce la successione (\ref{eq:Successione-primi-classi})
incrementando $k$, e per ogni primo $p_{k}$ ottenuto, se non vale
$p_{k}\backslash n$ fino a che $6k+1\leq\sqrt{n}$, allora $n$ è
primo.

\section{Algoritmo di Euclide}

\subsection{Definizione della successione}

La funzione principale di questo algoritmo, è calcolare il massimo
comune divisore di due numeri; presi due interi $m$ e $n$ tali che
$m<n$, vogliamo calcolare $\mcd mn$. Tramite questo algoritmo otteniamo
il risultato desiderato, senza passare per la scomposizione in fattori
primi di $m$ e $n$; definendo la seguente successione:
\begin{equation}
\begin{array}{c}
\mcd mn=\mcd{\mod nm}n=\mcd{\mod{\left(\mod nm\right)}n}n=\\
\ldots=\mcd 0n=n
\end{array}\label{eq:Successione-Euclide}
\end{equation}

Osserviamo come calcolare questa successione con un esempio.
\begin{example}
\emph{Calcolare il massimo comune divisore tra 482 e 1180}

$\checked$Procediamo applicando la definizione (\ref{eq:Successione-Euclide}):
per farlo dovremo scomporre il numero maggiore ($n$ dalla definizione)
usando il suo modulo rispetto al minore ($m$); in pratica prendiamo
1180 e lo dividiamo per 482, conservando il residuo dell'operazione
da usare nel termine successivo della successione
\[
\mcd{482}{1180}\rightarrow1180=2\cdot482+216
\]
proseguiamo lavorando col resto del passo precedente (216) e col valore
precedentemente usato per calcolare il modulo (482)
\[
\begin{array}{c}
\mcd{216}{482}\rightarrow482=2\cdot216+50\\
\mcd{50}{216}\rightarrow216=4\cdot50+16\\
\mcd{16}{50}\rightarrow3\cdot16+\boldsymbol{2}=\boldsymbol{d}\\
\mcd 2{16}\rightarrow8\cdot2+\boxed{0}
\end{array}
\]
La successione termina quando si ottiene resto zero; il resto chiamato
$d$, ottenuto alla penultima riga (sopra a quella con resto 0, vale
2 in questo caso) è effettivamente il risultato della richiesta: $\mcd{482}{1180}=2$\demo
\end{example}

\subsection{Algoritmo in forma simbolica}

Presi $a,\,b\in\mathbb{Z}$ tali che $a<b$, otteniamo $\mcd ab=d$
applicando (\ref{eq:Successione-Euclide}) nel seguente modo:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Algoritmo di Euclide}{\footnotesize{}\index{Euclide, algoritmo di@{\footnotesize{}Euclide, algoritmo di}}}}[1.8cm]
\begin{equation}
\begin{array}{c}
b=q_{1}\cdot a+r_{1}\\
a=q_{2}\cdot r_{1}+r_{2}\\
r_{1}=q_{3}\cdot r_{2}+r_{3}\\
\vdots\\
r_{k-2}=q_{k}\cdot r_{k-1}+r_{k}\\
r_{k-1}=q_{k+1}\cdot r_{k}+0\\
\boxed{r_{k}=d}
\end{array}\label{eq:Algoritmo-Euclide}
\end{equation}
dove $q_{i}$ è l'$i$-esimo quoziente e $r_{i}$ è l'$i$-esimo resto;
dall'algoritmo si può dedurre che, presi $a,\,b\neq0$ e sia $d=\mcd ab$,
allora è vero che $\exists x,\,y\in\mathbb{Z}\tc a\cdot x+b\cdot y=d$.
Questo risulta chiaro se immaginiamo che i due interi cercati siano
anche negativi; per trovare tali interi è necessario utilizzare una
estensione del (\ref{eq:Algoritmo-Euclide}).

\subsection{Algoritmo esteso}

L'algoritmo di Euclide presentato nella sottosezione precedente può
essere esteso, impiegando nel suo svolgimento due successioni $\left\{ x_{k}\right\} $
e $\left\{ y_{k}\right\} $: esse avranno i primi due valori ben definiti,
come
\begin{equation}
x_{0}=,\,x_{1}=1;\;y_{0}=1,\,y_{1}=0\label{eq:Premessa-successioni-Euclide-esteso}
\end{equation}

Facendo corrispondere ai passi (\ref{eq:Algoritmo-Euclide}) gli elementi
delle successioni $\left\{ x_{k}\right\} $ e $\left\{ y_{k}\right\} $,
possiamo ottenere gli elementi dal secondo in poi come:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Algoritmo di Euclide esteso}{\footnotesize{}\index{Euclide, algoritmo esteso di@{\footnotesize{}Euclide, algoritmo esteso di}}}}[1.2cm]
\begin{equation}
\begin{array}{cc}
x_{2}=-q_{1}\cdot x_{1}+x_{0} & y_{2}=-q_{1}\cdot y_{1}+y_{0}\\
x_{3}=-q_{2}\cdot x_{2}+x_{1} & y_{3}=-q_{2}\cdot y_{2}+y_{1}\\
x_{4}=-q_{3}\cdot x_{3}+x_{2} & y_{4}=-q_{3}\cdot y_{3}+y_{2}\\
\vdots & \vdots\\
\boxed{x_{k+1}}=-q_{k}\cdot x_{k}+x_{k-1} & \boxed{y_{k+1}}=-q_{k}\cdot y_{k}+y_{k-1}
\end{array}\label{eq:Algoritmo-Euclide-esteso}
\end{equation}
Osserviamo che gli elementi delle successioni in $x$ e $y$ si ottengono
in modo analogo, tuttavia le due successioni sono inizializzate in
modo differente (\ref{eq:Premessa-successioni-Euclide-esteso}). Euclide
Esteso ci permette di affermare che
\[
\mcd ab=d=a\cdot x_{k+1}+b\cdot y_{k+1}
\]
dove gli interi $x_{k+1}$ e $y_{k+1}$ sono ottenuti dalle successioni
(\ref{eq:Algoritmo-Euclide-esteso}); normalmente uno dei due è positivo
e l'altro è negativo.

\section{Congruenza in modulo}

\subsection{Definizione e proprietà}

Nelle sezioni precedenti abbiamo introdotto il simbolo di congruenza
`$\equiv$', che usato nel modo seguente implica che
\[
\cgm abn\implies\mod an=\mod bn\implies a-b=k\cdot n
\]
ovvero il fatto che $a$ sia congruente in modulo $n$ a $b$ implica
il fatto che $a$ e $b$ siano multipli; possiamo infatti dedurlo
osservando l'ultima implicazione, riscritta come
\[
a=b+k\cdot n
\]

Per la congruenza in modulo valgono alcune proprietà simili a quelle
dell'uguaglianza:
\begin{itemize}
\item $\cgm a0n\iff n\backslash a$
\item $\forall a\in\mathbb{Z}\tc\cgm aan$
\item $\cgm abn\iff\cgm ban$
\item $\cgm abn\land\cgm bcn\implies\cgm acn$
\end{itemize}

\subsection{Insieme dei residui}

Fin'ora abbiamo lavorato all'interno dell'insieme dei numeri interi
$\mathbb{Z}$; introduciamo l'insieme dei residui modulo $n$, indicato
come $\mathbb{Z}_{n}$, che contiene l'insieme dei valori da 0 a $n-1$
e al suo interno sono definite ciclicamente le operazioni di addizione,
sottrazione e moltiplicazione; osserviamo un esempio sull'addizione.
\begin{example}
\emph{\label{ex:Operazioni-insieme-residui}Determinare i risultati
delle seguenti operazioni, all'interno dell'insieme $\mathbb{Z}_{10}$:
$4+5,\,5+5,\,2-3,\,3\cdot4$.}

$\checked$Dalla definizione sappiamo che $\mathbb{Z}_{10}=\left\{ 0,1,2,3,4,5,6,7,8,9\right\} $,
allora le operazioni richieste valgono:
\[
4+5=9,\;5+5=0,\;2-3=9,\;3\cdot4=2
\]
\demo
\end{example}
La divisione in un insieme dei residui non è definita in modo banale
come le altre tre operazioni; introdurremo in seguito questa operazione.

\subsection{Insieme ridotto dei residui}

Dato un insieme dei residui $\mathbb{Z}_{n}$, possiamo definire il
suo insieme ridotto $\mathbb{Z}_{n}^{*}$, che contiene gli elementi
di $\mathbb{Z}_{n}$ che sono coprimi rispetto a $n$, ovvero
\[
\forall z\in\mathbb{Z}_{n}^{*}\tc z\in\mathbb{Z}_{n}\land z\perp n
\]
Procedendo con l'Esempio \ref{ex:Operazioni-insieme-residui}, l'insieme
ridotto dei residui modulo 10 avrà i seguenti elementi al suo interno:
\[
\mathbb{Z}_{10}^{*}=\left\{ 1,3,7,9\right\} 
\]
Notiamo che lo zero è sempre escluso dall'insieme ridotto, perché
non è coprimo rispetto ad alcun intero; la cardinalità di $\mathbb{Z}_{n}^{*}$
è determinata da una funzione di $n$ chiamata \emph{toziente} o \emph{$\varphi$
di Eulero}; in particolare vale $\varphi\left(10\right)=4$ (vedremo
in seguito come calcolare questa funzione).

\subsection{Equazioni congruenziali}

Una equazione congruenziale è una relazione definita su un'insieme
di residui; nel seguito vedremo delle proprietà che ci permetteranno
di operare con queste relazioni.
\begin{prop}
Prendiamo un intero $n\neq0$ e quattro interi $a,b,c,d$ tali che
\emph{$\cgm abn$ }e\emph{ $\cgm cdn$}; allora si verifica che\emph{
\[
\cgm{a+c}{b+d}n,\;\cgm{a-c}{b-d}n,\;\cgm{a\cdot c}{b\cdot d}n
\]
}
\end{prop}
Possiamo usare queste proprietà per risolvere la seguente equazione
congruenziale.
\begin{example}
\emph{Risolvere rispetto a $x$ l'equazione }$\cgm{x+7}3{17}$\emph{.}

$\checked$Dato che 7 è congruente a 3 in modulo 17, possiamo sfruttare
la seconda proprietà, per cui
\[
\begin{array}{c}
\cgm{x+7\boldsymbol{-7}}{3\boldsymbol{-7}}{17}\\
\cgm x{-4}{17}
\end{array}
\]
Osservando che $17-4=13$, otteniamo infine (è equivalente a scrivere
la congruenza con $-4$)
\[
\cgm x{13}{17}
\]
\demo
\end{example}
Ora introduciamo il concetto di divisione nell'insieme dei residui,
con una seconda proposizione.
\begin{prop}
Prendiamo un intero $n\neq0$ e tre interi $a,b,c$ con $a\perp n$
e vale \emph{$\cgm{a\cdot b}{a\cdot c}n$}; allora possiamo dire che
\emph{$\cgm{a\cdot b}{a\cdot c}n\implies\cgm bcn$}, tramite la moltiplicazione
da ambo i lati per l'inverso $a^{-1}$
\end{prop}
Possiamo risolvere una forma di equazione congruenziale più elaborata.
\begin{example}
\emph{Risolvere rispetto a $x$ l'equazione }$\cgm{2x+7}3{17}$\emph{.}

$\checked$Come nel caso precedente, possiamo sottrarre 7 da entrambi
i lati, dato che $\cgm 73{17}$, ottenendo
\[
\cgm{2x}{-4}{17}
\]
Ora sfruttando il fatto che $2\perp17$ la precedente diventa
\[
\cgm x{-2}{17}=\cgm x{15}{17}
\]
\demo
\end{example}
%
\begin{example}
\emph{Risolvere rispetto a $x$ l'equazione }$\cgm{5x+6}{13}{11}$\emph{.}

$\checked$Osservando che $\cgm 6{13}{11}$, applichiamo la proprietà
della divisione e otteniamo
\[
\cgm{5x}7{11}
\]
Se ora usiamo la proprietà della divisione (vale $5\perp11$) dovremo
scrivere
\[
\cgm x{\hat{\frac{7}{5}}}{11}
\]
dove la frazione $\hat{\nicefrac{7}{5}}$ in realtà non esiste nell'insieme
$\mathbb{Z}_{11}$; tuttavia sappiamo che $5x$ è congruente modulo
11 a 7, ma anche a (per la ciclicità dell'insieme dei residui) $7+11,\,7+22,\,\ldots\,,7+k\cdot11$;
il primo numero che sia un multiplo di 5 si ha per 3; abbiamo ottenuto
che $\left[7=40\right]\ni\mathbb{Z}_{11}$, quindi possiamo scrivere
\[
\begin{array}{c}
\cgm{5x}{40}{11}\\
\cgm x8{11}
\end{array}
\]
Possiamo in un certo senso affermare che 8 si comporta come $\nicefrac{7}{5}$
in $\mathbb{Z}_{11}$.

Esiste una seconda strada per risolvere questo esercizio; sapendo
che 5 e 11 sono primi relativi, usiamo il prodotto invece della divisione:
\[
\cgm{5x\cdot\boldsymbol{5^{-1}}}{7\cdot\boldsymbol{5^{-1}}}{11}
\]
L'inverso di un numero $n$ è quel numero $m$ tale che $n\cdot m=1$;
dunque cerchiamo l'elemento di $\mathbb{Z}_{11}$ che moltiplicato
per 5 risulta 1; troviamo $m\cdot5=1|_{\mathbb{Z}_{11}}\implies m=9$,
da cui segue che
\[
\cgm x{7\cdot9}{11}
\]
e dato che $7\cdot9=63=5\cdot11+8$ la precedente si scrive come
\[
\cgm x8{11}
\]
Abbiamo ottenuto il medesimo risultato a cui siamo arrivati attraverso
il primo procedimento.\demo
\end{example}
\begin{rem}
Presi $a\in\mathbb{Z}_{n}$ e $b\notin\mathbb{Z}_{n}^{*}$, non è
definita la divisione $a\div b$ (deve infatti valere $b\perp n\implies b\in\mathbb{Z}_{n}^{*}$).
\end{rem}
%
\begin{rem}
Se prendiamo l'equazione $\cgm{a\cdot x}bn$, essa ammetterà soluzione
se vale $a\perp n$; in tal caso $\exists a^{-1}\in\mathbb{Z}_{n}^{*}$
e la soluzione sarà $\cgm x{b\cdot a^{-1}}n$.
\end{rem}
Cosa possiamo concludere nel caso in cui, data l'equazione $E:\,\cgm{a\cdot x}bn$,
non sia vero che $a\perp n$, cioè nel caso in cui $\mcd an=d>1$?
In tal caso, l'equazione può non ammettere soluzione o ammetterne
$d$.

Se $d\backslash b$ allora dividiamo per $d$ tutte le quantità costanti,
ottenendo 
\[
\overline{E}:\,\cgm{\frac{a}{d}x}{\frac{b}{d}}{\frac{n}{d}}
\]
questa equazione ha ora una soluzione, perché $\mcd an=d\implies\mcd{\frac{a}{d}}{\frac{n}{d}}=\frac{d}{d}=1$
e ricadiamo nel caso dell'osservazione precedente.

Otteniamo la soluzione dell'equazione $\overline{E}$ e la chiamiamo
$x_{0}$, la quale sarà in modulo $\nicefrac{n}{d}$ ($x_{0}\in\mathbb{Z}_{n/d}$);
dato che l'equazione di partenza $E$ ha soluzioni in $\mathbb{Z}_{n}$,
esse saranno i termini della successione
\[
\left\{ x\right\} =x_{0},\,x_{0}+\frac{n}{d},\,x_{0}+2\frac{n}{d},\,\ldots\,,\,x_{0}+\left(d-1\right)\frac{n}{d}
\]
Osserviamo l'esempio di un'equazione con queste caratteristiche.
\begin{example}
\emph{Risolvere rispetto a $x$ l'equazione }$\cgm{12x}{21}{39}$\emph{.}

$\checked$Osserviamo subito che $\mcd{12}{39}=3$, dunque l'equazione
avrà 0 o 3 soluzioni; dividiamo le costanti per 3 e otteniamo
\[
\cgm{4x}7{13}
\]
da cui otteniamo $\cgm x{\hat{\frac{7}{4}}}{13}$ e trovando $4\backslash\left(7+1\cdot13\right)=20$
la precedente equazione fornisce una soluzione $\cgm{x_{0}}5n$; adesso
usiamo la successione delle soluzioni $\left\{ x\right\} $ per ottenere
tutte le soluzioni dell'equazione di partenza:
\[
x=\left\{ x_{0}=\boxed{5},\,x_{0}+\frac{39}{3}=\boxed{18},\,x_{0}+\frac{2\cdot39}{3}=\boxed{31}\right\} 
\]
Possiamo immaginare le radici di $E$ come dei punti su una circonferenza,
a distanza $d/n$ da $x_{0}$.\demo

Posto che valga $a\perp n$ (ovvero $\mcd an=1$), come possiamo calcolare
l'inverso $a^{-1}$? Potremmo tentare tutti i numeri da $1$ a $n-1$
conducendo un'analisi esaustiva, tuttavia per $n$ molto grande questo
non è pratico; usiamo allora l'algoritmo di Euclide esteso (\ref{eq:Algoritmo-Euclide-esteso}):
esso ci garantisce che
\[
\mcd an=1\implies\exists s,t\in\mathbb{Z}_{n}\tc a\cdot s+n\cdot t=1
\]
segue dalla precedente relazione che $a\cdot s=1-n\cdot t$, allora
abbiamo $\cgm{a\cdot s}1n$ e risolvendo l'equazione si ottiene
\[
\cgm s{a^{-1}}n
\]
ovvero il numero $s$ è proprio l'elemento finale $x_{k+1}$ della
sequenza di $x$ dell'algoritmo; esso risulta essere anche il valore
cercato dell'inverso $a^{-1}$.
\end{example}

\section{Teorema cinese del resto}

\subsection{Applicazione ed enunciato}

Mostriamo direttamente l'applicazione del teorema a un caso specifico:
prendiamo $\cgm x{25}{42}$; possiamo esprimere $x=25+6\cdot\left(7\cdot k\right)\rightleftarrows25+7\cdot\left(6\cdot k\right)$,
da cui ricaviamo
\begin{itemize}
\item per $x=25+6\cdot\left(7\cdot k\right)$: $\mod{25}6=1\implies\cgm x16$
\item per $x=25+7\cdot\left(6\cdot k\right)$: $\mod{25}7=3\implies\cgm x37$
\end{itemize}
Dalle due congruenze più semplici ottenute possiamo scrivere il sistema
\[
\cgm x{25}{42}\implies\begin{cases}
\cgm x16\\
\cgm x37
\end{cases}
\]
Il teorema cinese del resto afferma che:
\begin{thm}
Dati\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Teorema cinese del resto}{\footnotesize{}\index{Cinese, teorema del resto@{\footnotesize{}Cinese, teorema del resto}}\label{thm:Teorema-cinese-del-resto}}}[0.0cm] due interi $n,\,m$ che siano \uline{primi relativi} (deve
valere $n\perp m$), e presi due interi $a,\,b$, allora il sistema
delle congruenze\emph{
\[
\begin{cases}
\cgm xan\\
\cgm xbm
\end{cases}
\]
}è equivalente alla singola congruenza\emph{
\[
\cgm xc{n\cdot m}
\]
}
\end{thm}
Il teorema afferma che, quanto introdotto all'inizio della sezione,
può valere nel senso opposto in alcune condizioni specifiche.Osserviamo
l'applicazione del teorema in un esempio.
\begin{example}
\emph{Sia dato il seguente insieme di congruenze:}
\[
\begin{cases}
\cgm x37\\
\cgm x5{15}
\end{cases}
\]
\emph{Scrivere una forma equivalente, con una singola congruenza.}

$\checked$Dato che $7\perp15$, per il Teorema \ref{thm:Teorema-cinese-del-resto}
possiamo affermare che esisterà una singola congruenza equivalente
alle due della consegna; essa sarà scritta nella forma $\cgm xc{105}$.
Per ottenere $c$ possiamo provare i numeri multipli di 5, i quali
in modulo 7 diano 3 come risultato; si ottiene facilmente $c=80$
(possiamo scomporlo come $80=11\cdot7+3$).

Nel caso di numeri molto grandi, non è possibile scegliere di procedere
per tentativi, ed è necessario usare gli strumenti della teoria dei
numeri: se sappiamo che $\cgm xan$ e anche $\cgm xbm$, allora possiamo
scrivere
\[
\cgm{x=b+\overline{k}\cdot m}an
\]
risolvendo questa relazione si ottiene $\cgm{a-b}{\overline{k}\cdot m}n$
da cui, rispetto a $\overline{k}$ otteniamo
\[
\cgm{\overline{k}}{\left(a-b\right)\cdot m^{-1}}n
\]
Il valore $\overline{k}$ corrisponde al $c$ del Teorema \ref{thm:Teorema-cinese-del-resto},
esso infatti è congruente sia ad $a$ in modulo $n$, sia a $b$ in
modulo $m$.\demo
\end{example}

\subsection{Estensione}

Il Teorema \ref{thm:Teorema-cinese-del-resto} ammette un'estensione
a un caso generale, con $N$ congruenze.
\begin{cor}
Prendiamo\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Teorema cinese del resto esteso}{\footnotesize{}\index{Cinese, teorema del resto esteso@{\footnotesize{}Cinese, teorema del resto esteso}}\label{thm:Teorema-cinese-del-resto-esteso}}}[0.0cm] $N$ numeri interi, indicati come $m_{i}\tc i\in\left[1,\,N\right]$,
tali che a coppie siano tutti coprimi ($\forall i,j\in\left[1,\,N\right]\land i\neq j\tc m_{i}\perp m_{j}$).
Se abbiamo il seguente sistema di congruenze
\[
\begin{cases}
\cgm x{a_{1}}{m_{1}}\\
\cgm x{a_{2}}{m_{2}}\\
\\
\cgm x{a_{N}}{m_{N}}
\end{cases}
\]
è equivalente alla singola congruenza
\[
\cgm xC{\prod_{i=1}^{N}m_{i}}
\]
\end{cor}
Tale congruenza si costruisce a partire dalle seguenti serie:
\[
M=\prod_{i=1}^{N}m_{i};\quad Z_{i}=\frac{M}{m_{i}};\quad Y_{i}=\mod{Z_{i}^{-1}}{m_{i}}
\]
Otteniamo infine la seguente soluzione, equivalente a una singola
congruenza:
\begin{equation}
X=\mod{\serie{i=1}N{a_{i}Y_{i}Z_{i}}}M\label{eq:Congruenza-equivalente-sistema}
\end{equation}


\section{Square \& multiply\label{sec:Square-=000026-multiply}}

Tramite l'algoritmo chiamato square and multiply, è possibile calcolare
il modulo di un numero che abbia molte cifre; mostriamo un esempio
per illustrare l'idea dietro a questo algoritmo, usando numeri ``piccoli''.
\begin{example}
\emph{Si calcoli il risultato dell'operazione} $\mod{7^{11}}{26}$.

$\checked$Eseguiamo i seguenti passi per cercare il valore desiderato:\marginpar{LSB indica il least significant bit (bit meno significativo) e si
riferisce al primo bit da destra}[0.8cm]
\end{example}
\begin{enumerate}
\item Esprimiamo 11 (l'esponente) in forma binaria: $11_{10}=1011_{2}=1\cdot2^{3}+0\cdot2^{2}+1\cdot2^{1}+1\cdot2^{0}$;
\item Sostituire 11 con la sua rappresentazione binaria: $7^{11}=7^{\left(8+2+1\right)}=7^{8}\cdot7^{2}\cdot7$;
\item Scriviamo i bit di 11 in colonna, al contrario (a partire dal LSB):
$\begin{bmatrix}1 & 1 & 0 & 1\end{bmatrix}$;
\item Scriviamo accanto a ciascun bit la potenza di 7 corrispondente, ottenuta
dalla scomposizione al punto ${\scriptstyle \left(1\right)}$;
\item Scriviamo accanto alle potenze $7^{i}$ il risultato dell'operazione
$\mod{7^{i}}{26}$;
\item Componiamo il risultato prendendo il prodotto dei valori scritti al
punto ${\scriptstyle \left(5\right)}$ in corrispondenza di un 1,
scritto al punto ${\scriptstyle \left(3\right)}$
\end{enumerate}
Otterremo infine:
\[
\begin{array}{ccc}
\boldsymbol{1} & 7^{1} & \boxed{7}\\
\boldsymbol{1} & 7^{2} & \boxed{23}\\
0 & 7^{4} & 9\\
\boldsymbol{1} & 7^{8} & \boxed{3}
\end{array}\implies\mod{\left(7\cdot23\cdot3\right)}{26}=15
\]
Il vantaggio di questo metodo è il fatto che si basa solo sull'operazione
di elevamento al quadrato di numeri piccoli (relativamente al modulo,
nell'esercizio siamo in $\mathbb{Z}_{26}$). In totale, saranno necessari
(per questo caso dell'esercizio) $2\cdot\log_{2}\left(11\right)\simeq4$.\demo

\section{Teorema piccolo di Fermat}
\begin{thm}
Sia\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Teorema piccolo di Fermat}{\footnotesize{}\index{Fermat, teorema piccolo di@{\footnotesize{}Fermat, teorema piccolo di}}\label{thm:Teorema-piccolo-Fermat}}}[0.0cm] $p$ un intero primo, e $a$ un intero tale che $p$ \uline{non}
divida $a$, allora è vero che\emph{
\begin{equation}
\cgm{a^{p-1}}1p\label{eq:Teorema-piccolo-Fermat}
\end{equation}
}
\end{thm}
Non vale l'implicazione inversa, infatti prendendo $a$ ed $n$ due
interi qualsiasi, e osservando che $\cgm{a^{n-1}}1n$, non possiamo
dedurre che $n$ sia primo.

Piuttosto possiamo usare il Teorema \ref{thm:Teorema-piccolo-Fermat}
per provare che un numero sia composto (non primo); tuttavia i numeri
composti che danno resto 1 non ostante non siano primi sono pochi,
e sono definiti \emph{pseudo-primi}. Questi numeri sono sempre più
rarefatti all'aumentare dell'ordine di grandezza.

Non ostante la scelta di una base $a$ differente possa ``smascherare''
un numero pseudo-primo, esiste una categoria di interi chiamati \emph{pseudo-primi
assoluti}, i quali forniscono resto 1 con qualunque base scelta nel
test del teorema piccolo di Fermat.
\begin{rem}
Abbiamo concluso dal Teorema \ref{thm:Teorema-piccolo-Fermat} che,
se non è vero $p\backslash a$, allora vale $\cgm{a^{p-1}}1p$; possiamo
scrivere questa congruenza in modo equivalente come $\cgm{a\cdot a^{p-2}}1p$,
che può essere risolta con la regola della divisione nel modo seguente:
\begin{equation}
\cgm{a^{p-2}}{a^{-1}}p\label{eq:Osservazione-inverso-p-2}
\end{equation}
Abbiamo appena ottenuto un nuovo metodo per calcolare l'inverso di
un intero $a$.
\end{rem}
Poniamoci nel caso generale, in cui abbiamo un intero qualunque $a$
e un intero composto $n$: la condizione del teorema diventa che $a\perp n$;
in queste condizioni possiamo enunciare il seguente Teorema \ref{thm:Teorema-Eulero}.
\begin{thm}
Sia\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Teorema di Eulero}{\footnotesize{}\index{Eulero, teorema di@{\footnotesize{}Eulero, teorema di}}\label{thm:Teorema-Eulero}}}[0.0cm] $a$ un intero qualunque e $n$ un intero composto, tali
che $a\perp n$, allora è vero che
\begin{equation}
\cgm{a^{\varphi\left(n\right)}}1n\label{eq:Teorema-Eulero}
\end{equation}
\end{thm}
La funzione \emph{toziente} $\varphi\left(p\right)$ con $p$ numero
primo, è il numero di primi relativi rispetto a $p$, in questo caso
$p-1$ numeri, tutti i predecessori di $p$, il quale essendo primo
ha come fattore comune con essi solo 1; vale dunque $\varphi\left(p\right)=p-1$
per $p$ numero primo.

In generale il toziente di un intero $n$ qualunque si può calcolare
in uno dei seguenti modi:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Toziente}{\footnotesize{}\index{Toziente@{\footnotesize{}Toziente}}\label{eqn:Toziente}}}[1.2cm]
\begin{itemize}
\item $\varphi\left(n\right)=n\cdot\prod_{i\in\left[1,n-1\right],\,p_{i}\backslash n}\left(1-\dfrac{1}{p_{i}}\right)$
\item $n=\prod_{i=1}^{m}p_{i}^{r_{i}}\implies\varphi\left(n\right)=\prod_{i=1}^{m}\left(p_{i}^{r_{i}}-p_{i}^{r_{i}-1}\right)$
\end{itemize}
Vediamo un esempio in cui calcoliamo il toziente di due numeri adoperando
entrambi i procedimenti:
\begin{example}
\emph{Calcolare il toziente di 1000.}

$\checked$Adoperando il primo metodo, scriviamo la scomposizione
di 1000 nei suoi fattori primi: $1000=2^{3}\cdot5^{3}$; scriviamo
dunque la produttoria usando i due fattori $p_{i}=\left\{ 2,\,5\right\} $
senza esponente
\[
1000\cdot\left(1-\frac{1}{2}\right)\cdot\left(1-\frac{1}{5}\right)=\boxed{400}=\varphi\left(1000\right)
\]
Se adoperiamo il secondo metodo, scriviamo direttamente la produttoria
a partire dai fattori primi $2^{3}$ e $5^{3}$:
\[
\left(2^{3}-2^{2}\right)\cdot\left(5^{3}-5^{2}\right)=\boxed{400}=\varphi\left(1000\right)
\]
Abbiamo ottenuto lo stesso toziente, mostrando che entrambi i procedimenti
si equivalgono.\demo
\end{example}
\begin{rem}
Se vogliamo calcolare l'inverso di un intero $a$ modulo $n$ non
primo, posto che $a\perp n$ possiamo scrivere la congruenza
\[
\cgm{a^{-1}}{a^{\varphi\left(n\right)-1}}n
\]
Questa relazione ci permette di calcolare un inverso utilizzando il
modulo di un elevamento a potenza (evitando la strada di Euclide esteso
(\ref{eq:Algoritmo-Euclide-esteso})), per esempio tramite square
and multiply eseguito su un calcolatore.
\end{rem}
Mettendo assieme quanto illustrato in questa sezione, possiamo rispondere
alla richiesta mostrata nel seguente esempio.
\begin{example}
\emph{Calcolare le ultime tre cifre di} $7^{803}$.\label{ex:Ultime-3-cifre-7}

$\checked$Le ultime tre cifre di un numero possono essere ottenute
usando il resto della sua divisione per $10^{3}$; allora dobbiamo
trovare il risultato di $\mod{7^{803}}{1000}$.

Per il teorema di Eulero (\ref{eq:Teorema-Eulero}) sappiamo che $\cgm{7^{\varphi\left(1000\right)}}1{1000}$
e dal precedente esempio abbiamo già calcolato $\varphi\left(1000\right)=400$,
per cui possiamo scomporre $7^{803}$ nel modo seguente:
\[
\mod{\left(7^{400}\cdot7^{400}\cdot7^{3}\right)}{1000}=\mod{\left(1\cdot1\cdot343\right)}{1000}=\boxed{343}
\]
\demo
\end{example}

\section{Principio fondamentale}

Se abbiamo gli interi $a,\,b,\,n,\,x,\,y$ e $n>0$, tali che $a\perp n$,
allora se $\cgm xy{\varphi\left(n\right)}$ vale
\begin{equation}
\cgm{a^{x}}{b^{y}}n\label{eq:Principio-fondamentale}
\end{equation}
tuttavia non vale l'implicazione inversa.

Concludiamo che, in una congruenza modulo $n$, in presenza di elevamenti
a potenza gli esponenti della stessa base lavorano in modulo di $\varphi\left(n\right)$.

Questo principio permette di risolvere rapidamente la richiesta dell'Esercizio
\ref{ex:Ultime-3-cifre-7}: dato che $\cgm{803}3{\varphi\left(1000\right)=400}$
otteniamo direttamente $\cgm{7^{803}}{7^{3}}{1000}$; abbiamo usato
(\ref{eq:Principio-fondamentale}) in cui $x=803$ e $y=3$.

\section{Radici in aritmetica modulare}

\subsection{Radici primitive}

Introduciamo il concetto di gruppo algebrico:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Gruppo algebrico}{\footnotesize{}\index{Gruppo algebrico@{\footnotesize{}Gruppo algebrico}}\label{def:Gruppo-algebrico}}}[0.3cm]

\begin{minipage}[t]{0.9\textwidth}%
\begin{center}
\emph{Chiamiamo }gruppo\emph{ una struttura formata da un insieme
e da un'operazione binaria definita su di esso, la quale soddisfi
gli assiomi di associatività, esistenza dell'elemento neutro ed esistenza
dell'elemento inverso}
\par\end{center}%
\end{minipage}

Ad esempio, se prendiamo l'insieme dei numeri interi $\mathbb{Z}$
e l'operazione di somma $+$, possiamo formare il gruppo $\left(\mathbb{Z},\,+\right)$
poiché la somma è associativa, l'elemento neutro è lo zero e l'inverso
di qualunque elemento è sempre definito; anche prendendo $\mathbb{Z}_{p}^{*}$
(insieme dei residui interi modulo $p$, escluso lo 0) e l'operazione
di prodotto, otteniamo di nuovo un gruppo $\left(\mathbb{Z}_{p}^{*},\,\cdot\right)$.
Non si ottiene un gruppo rispetto al prodotto per $\mathbb{Z}_{p}$
(residui modulo $p$, da 0 a $p-1$), poiché lo 0 non ha un inverso
definito.\bigskip{}

Se prendiamo un elemento $a\in\mathbb{Z}_{p}^{*}$ allora vale $\cgm{a^{p-1}}1p$
per il Teorema \ref{thm:Teorema-piccolo-Fermat}; chiamiamo inoltre
ordine dell'elemento $a$ (e lo indichiamo tramite $\ord a$) l'intero
$n>0$ più piccolo tale che
\begin{equation}
\cgm{a^{n}}1p\label{eq:Ordine-di-intero}
\end{equation}
Il teorema piccolo di Fermat (\ref{eq:Teorema-piccolo-Fermat}) ci
assicura che vale sempre $n\leq p-1$, ma non è detto che sia proprio
$n=p-1$. Chiamiamo quindi $\alpha$ l'elemento primitivo $a\in\mathbb{Z}_{p}^{*}$
se e solo se l'ordine di $a$ è 1, ovvero non esiste nessun altro
intero $n$ per cui $\cgm{a^{n}}1p$; in altri termini vale
\begin{equation}
\cgm{a^{n}}1p\iff n=1\label{eq:Condizione-elemento-primitivo}
\end{equation}
Se l'ordine di $a$ fosse proprio $p-1$, allora preso $\alpha^{i}$
l'elemento primitivo, presi tutti gli interi $i\in\left[1,\,p-1\right]$,
otteniamo dalla successione degli $\alpha^{i}$ tutti e soli gli elementi
dell'insieme $\mathbb{Z}_{p}^{*}$ (in ordine anche differente); chiameremo
l'elemento $\alpha$ la \emph{radice primitiva}.

\begin{minipage}[t]{0.9\columnwidth}%
\begin{center}
\emph{Chiamiamo $\alpha$ una radice primitiva per $p$ se vale (\ref{eq:Condizione-elemento-primitivo})
e inoltre l'ordine di $\alpha$ è pari a $n=p-1$.}
\par\end{center}%
\end{minipage}\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Radice primitiva}{\footnotesize{}\index{Radice primitiva@{\footnotesize{}Radice primitiva}}\label{def:Radice-primitiva}}}[-0.2cm]
\begin{example}
\emph{Trovare se $\alpha=3$ sia una radice primitiva di $p=7$.}
\end{example}
$\checked$Per trovare se $\alpha$ sia effettivamente una radice
primitiva di $p$, calcoliamo gli elementi:
\[
\left\{ \forall i\in\left[0,\,p-1\right]\,:\,\cgm{\beta}{\alpha^{i}}p\right\} 
\]
Otteniamo quindi:
\[
\begin{array}{c}
\cgm{3^{0}}17\\
\cgm{3^{1}}37\\
\cgm{3^{2}}27\\
\cgm{3^{3}}67\\
\cgm{3^{4}}47\\
\cgm{3^{5}}57\\
\vdots
\end{array}
\]
Abbiamo riottenuto tutti e soli gli elementi da $1$ a $p-1=6$ (i
membri di $\mathbb{Z}_{7}^{*}$), con periodo $p-1=6$. Si verifica
dunque la condizione che rende un elemento primitivo $\alpha$ una
radice per $p$; la radice primitiva è anche detta elemento generatore:
infatti, tramite essa è possibile ottenere tutti i residui in modulo
$p$ di un certo insieme $\mathbb{Z}_{p}^{*}$.\demo
\begin{example}
\emph{Trovare se $\alpha=2$ sia una radice primitiva di $p=7$.}
\end{example}
$\checked$Calcolando di nuovo gli $\alpha^{i}$ con $i\in\left[0,\,p-1\right]$
otteniamo
\[
\begin{array}{c}
\cgm{2^{0}}17\\
\cgm{2^{1}}27\\
\cgm{2^{2}}47\\
\cgm{2^{3}}17\\
\vdots
\end{array}
\]
In questo caso abbiamo ottenuto periodo 3; inoltre l'ordine di $\alpha$
è $n=3\neq p-1=6$, quindi $\alpha=2$ non è radice primitiva di $p=7$.\demo
\begin{rem}
Se prendiamo l'elemento primitivo $a\in\mathbb{Z}_{p}^{*}$, esso
avrà al massimo ordine $p-1$; tuttavia potrà presentare anche ordini
pari ai sottomultipli di $p-1$, ma non ordini differenti da essi.
\end{rem}
%
\begin{rem}
Se $\alpha$ è un elemento primitivo di $\mathbb{Z}_{p}^{*}$ e vale
$\cgm{\beta}{\alpha^{i}}p$ con $1\leq i\leq p-1$, questi $\beta$
sono tutti e soli gli elementi di $\mathbb{Z}_{p}^{*}$. Se ora prendiamo
un elemento primitivo di $\mathbb{Z}_{p}^{*}$ espresso come $\beta$
(tramite la precedente congruenza), il suo ordine sarà dipendente
dall'esponente $i$ usato per ottenerlo a partire da $\alpha,$e dovrà
valere
\begin{equation}
\ord{\beta}=\frac{p-1}{\mcd{p-1}i}\label{eq:Elemento-primitivo-MCD}
\end{equation}
dove $i$ è l'esponente a cui elevare $\alpha$ per ottenere $\beta$.
Questo si verifica perché i $\beta$sono potenze di $\alpha$, ed
essendo $\ord{\alpha}=p-1$ ($\alpha$ è radice primitiva) necessariamente
l'ordine di $\beta$ sarà un sottomultiplo di $p-1$, determinato
da (\ref{eq:Elemento-primitivo-MCD})

Gli elementi primitivi di $\mathbb{Z}_{p}^{*}$ sono in numero $\varphi\left(p-1\right)$;
infatti saranno tutti gli elementi di $\mathbb{Z}_{p}^{*}$. coprimi
rispetto a $p-1$, per cui si verifica la condizione (\ref{eq:Elemento-primitivo-MCD}).
Notiamo infatti che $\beta$ è una radice primitiva di $p$ (vale
$\ord{\beta}=p-1$) quando si ha$\mcd{p-1}i=1$; concludiamo che il
numero di elementi primitivi $\beta$ di un insieme $\mathbb{Z}_{p}^{*}$
è il numero di elementi coprimi rispetto a $p-1$ (valore ottenuto
dalla funzione toziente di $p-1$).
\end{rem}

\subsection{Test di primitività}

Prendiamo un $\alpha\in\mathbb{Z}_{p}^{*}$ con $p$ qualunque, e
cerchiamo se $\alpha$ sia primitivo o meno rispetto a $p$; usiamo
il seguente test di primitività: scomporre $p-1$ nei suoi fattori
primi, in modo da avere una produttoria di quozienti elevati a un
certo esponente $p-1=\prod_{i}q_{i}^{r_{i}}$; diremo che $\alpha$
è primitivo rispetto a $p$ se e solo se vale\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Test primitività}{\footnotesize{}\index{Test primitività@{\footnotesize{}Test primitività}}}}[0.4cm]
\begin{equation}
\forall i\,:\,\ncgm{\alpha^{\left(p-1\right)/q_{i}}}1p\label{eq:Test-primitivit=0000E0}
\end{equation}
Si noti che $p$ è primo (per definizione), di conseguenza $p-1$
è sempre pari.
\begin{example}
\emph{Ottenere se $\alpha=2$ sia radice primitiva per $p=19$.}
\end{example}
$\checked$Usando il test (\ref{eq:Test-primitivit=0000E0}), scomponiamo
$19-1=18$ nei suoi fattori primi:
\[
18=2\cdot3^{2}
\]
Ora testiamo la congruenza per tutti i fattori primi (presi senza
esponente):
\[
\begin{array}{c}
\cgm{2^{18/3}=2^{6}=64}7{19}\\
\cgm{2^{18/2}=2^{9}=512}{18}{19}
\end{array}
\]
Per nessun fattore primo si ha congruenza a 1 modulo 19, dunque $\alpha=2$
è davvero una radice primitiva per $p=19$.

Osserviamo infine che gli elementi primitivi di $\mathbb{Z}_{19}$
sono $\varphi\left(18\right)=6$, distribuiti all'interno dell'insieme
in modo non predicibile.\demo

\subsection{Radici quadrate}

Poniamoci nel caso di radici quadrate in modulo a un intero $p$ primo;
inoltre, consideriamo per tale intero solamente la metà dei numeri
primi (si ricordi la separazione dei primi in classi di congruenza
(\ref{eq:Successione-primi-classi})):
\begin{equation}
\cgm p34\label{eq:Condizione-radici-quadrate-modulo-primo}
\end{equation}
Risolviamo, sotto queste condizioni, l'equazione $\cgm{x^{2}}ap$,
ovvero cerchiamo $\sqrt{a}\in\mathbb{Z}_{p}$; si dimostra che, se
esiste $\sqrt{a}$, allora vale:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Radice quadrata}{\footnotesize{}\index{Radice quadrata@{\footnotesize{}Radice quadrata}}}}[0.4cm]
\begin{equation}
\pm a^{\left(p+1\right)/4}=\sqrt{a}\,\lor\,\pm a^{\left(p+1\right)/4}=\sqrt{-a}\label{eq:Radice-quadrata-modulo-primo}
\end{equation}
dove abbiamo l'unione di due condizioni che sono esclusive (se non
esiste la radice di $a$ allora esisterà quella di $-a$, e vale quanto
indicato in (\ref{eq:Radice-quadrata-modulo-primo}), e vice versa).
\begin{rem}
\label{oss:Condizioni-esistenza-radici}Se avessimo $\ncgm p34$ ma
$\cgm p14$ ($p$ appartenente all'altra classe di congruenze), allora
nel caso in cui non esista una delle due radici ($\sqrt{a}$ o $\sqrt{-a}$)
non esiste nemmeno l'altra.
\end{rem}
\begin{example}
\emph{Si calcoli, se esiste, la radice di 5 in modulo 11.}
\end{example}
$\checked$Cercare $\mod{\sqrt{5}}{11}$ equivale a risolvere l'equazione
\[
\cgm{x^{2}}5{11}
\]
Dato che per 11 vale (\ref{eq:Condizione-radici-quadrate-modulo-primo}),
possiamo usare la formula (\ref{eq:Radice-quadrata-modulo-primo}):
\[
\pm5^{\left(11+1\right)/4}=\mod{\pm125}{11}=\pm4
\]
Per determinare se in modulo 11 i numeri $\pm4$ siano la radice di
$5$ o di $-5$, effettuiamo l'elevamento a potenza della radice cercata:
\[
\mod{4^{2}}{11=5},\quad-4^{2}=\mod{7^{2}}{11}=5
\]
Abbiamo ottenuto che la radice quadrata di 5 modulo 11 è $\pm4$.\demo
\begin{example}
\emph{Si calcoli, se esiste, la radice di 2 in modulo 11.}
\end{example}
$\checked$Come prima, impostiamo così l'equazione da risolvere:
\[
\cgm{x^{2}}2{11}
\]
Possiamo usare (\ref{eq:Radice-quadrata-modulo-primo}), dato che
per 2 vale (\ref{eq:Condizione-radici-quadrate-modulo-primo}):
\[
\pm2^{\left(11+1\right)/4}=\mod{\pm8}{11}=\pm8
\]
Infine effettuiamo l'elevamento a potenza della radice per ottenere
il segno:
\[
\mod{8^{2}}{11}=\mod 9{11}=-2
\]
Abbiamo ottenuto che in modulo 11 non esiste la radice quadrata di
2; la radice di $-2$ però esiste, e vale $\pm8$.\demo

\subsection{Test per segno della radice}

Prendiamo un primo $p$ dispari, un $a\neq0$ in modulo $p$, allora
\begin{equation}
\cgm{a^{\left(p-1\right)/2}}{\pm1}p\label{eq:Test-segno-radice-prima}
\end{equation}
Distinguiamo i due casi:
\begin{itemize}
\item se il segno in (\ref{eq:Test-segno-radice-prima}) è $+$, allora
esiste $\sqrt{a}$ in modulo $p$;
\item se il segno in (\ref{eq:Test-segno-radice-prima}) è $-$, allora
esiste $\sqrt{-a}$ in modulo $p$.
\end{itemize}
Ricordando l'Osservazione \ref{oss:Condizioni-esistenza-radici},
si nota che il test appena mostrato permette di affermare se la radice
non sia definita, nel caso in cui $\cgm p14$ e in cui il segno in
(\ref{eq:Test-segno-radice-prima}) sia $-$.

\subsection{Radice quadrata modulo composto}

Esaminiamo il problema $\cgm{x^{2}}an$ dove $n$ sia un numero composto;
dato che $n$ sarà scomponibile in fattori primi, possiamo scomporre
la congruenza esaminata in due congruenze più semplici in modulo $p$
e $q$, sapendo che $n=p\cdot q$. Le due soluzioni ottenute si combinano
infine tramite il Teorema \ref{thm:Teorema-cinese-del-resto}.

Questo problema ha la sua difficoltà nella fattorizzazione di $n$,
al punto che la complessità computazionale del calcolo della radice
modulo $n$ equivale a quella della sua scomposizione in fattori primi.
\begin{example}
\emph{Si calcoli, se esiste, la radice di 71 in modulo 77.}
\end{example}
$\checked$Notiamo subito che $77=7\cdot11$; per il Teorema \ref{thm:Teorema-cinese-del-resto}
possiamo scomporre la congruenza in esame nelle due più semplici:
\[
\cgm{x^{2}}{71}{77}\implies\begin{cases}
\cgm{x^{2}}17\\
\cgm{x^{2}}5{11}
\end{cases}
\]
Nella precedente abbiamo già sostituito $\mod{71}7=1$ e $\mod{71}{11}=5$;
possiamo risolvere le due congruenze in modo indipendente:
\begin{enumerate}
\item la radice quadrata di 1 è comunque $\pm1$, modulo 7;
\item la radice quadrata di 5 modulo 11 si può ottenere da (\ref{eq:Radice-quadrata-modulo-primo})
e risulta $\cgm x{\pm5^{\left(11+1\right)/4}}{11}\implies\cgm x{\pm4}{11}$.
\end{enumerate}
Abbiamo ottenuto due radici da ciascuna congruenza, che possono essere
combinate in $2^{2}=4$ modi possibili, per costruire la soluzione
tramite il Teorema \ref{thm:Teorema-cinese-del-resto}.
\begin{itemize}
\item $\left\{ \cgm x17;\;\cgm x4{11}\right\} $\\
Risolviamo la combinazione delle due congruenze analizzate:
\[
\begin{array}{c}
x=\cgm{1+k\cdot7}4{11}\\
\cgm{7\cdot k}3{11}\\
\cgm k{3\cdot7^{-1}}{11}
\end{array}
\]
Per trovare l'inverso utilizziamo (\ref{eq:Osservazione-inverso-p-2}),
da cui $\mod{7^{-1}}{11}=\mod{7^{9}}{11}=8$, da cui segue che $k=\mod{24}{11}=2$;
sostituendo nella prima si ottiene
\[
x=\cgm{14+1}4{11}\implies\boxed{\cgm x{15}{77}}
\]
dal Teorema \ref{thm:Teorema-cinese-del-resto}.\bigskip{}
\item $\left\{ \cgm x17;\;\cgm x{-4}{11}\right\} $
\[
\cgm x{-15}{77}
\]
\smallskip{}
\item $\left\{ \cgm x{-1}7;\;\cgm x4{11}\right\} $
\[
\cgm x{29}{77}
\]
\smallskip{}
\item $\left\{ \cgm x{-1}7;\;\cgm x{-4}{11}\right\} $
\[
\cgm x{-29}{77}
\]
\end{itemize}
Non è detto che le radici siano sempre 4, in questo caso esistevano
tutte le radici per ciascuna congruenza in cui è stata scomposta quella
iniziale.\demo

\subsection{Residui quadratici}

Abbiamo chiamato gli elementi di $\mathbb{Z}_{p}^{*}$ residui modulo
$p$; i residui quadratici sono residui che corrispondono anche al
quadrato di qualche elemento dello stesso insieme $\mathbb{Z}_{p}^{*}$.

Chiamiamo $a_{q}\in\mathbb{Z}_{p}^{*}$i residui quadratici per cui
valga
\[
\cgm{a_{q}}{\left(\pm b\right)^{2}}p
\]
con $b\in\mathbb{Z}_{p}^{*}$ un elemento dell'insieme a cui appartiene
anche $a_{q}$.

Osserviamo che $p\in\left\{ 1,\,2,\,\ldots,\,\frac{p-1}{2}\right\} $,
poiché i residui a partire da $\frac{p-1}{2}+1$ sono i residui negativi
dei precedenti dal minore al maggiore ($-1=p-1$).
\begin{example}
\emph{\label{exa:Trovare-i-residui}Trovare i residui quadratici dell'insieme
$\mathbb{Z}_{11}^{*}$.}
\end{example}
$\checked$Otteniamo subito che nell'insieme analizzato ci sono $\frac{p-1}{2}=\frac{11-1}{2}=5$
residui quadratici; possiamo ottenerli tramite il test (\ref{eq:Test-segno-radice-prima}):
\[
\ncgm{a^{\left(p-1\right)/2}}{+1}p\implies a\text{ \textbf{non} è residuo quadratico!}
\]
Effettuiamo questo test per ciascun elemento di $\mathbb{Z}_{11}^{*}$:
\[
\begin{array}{ll}
\cgm{1^{5}}{\boxed{1}}{11} & \cgm{6^{5}}{-1}{11}\\
\cgm{2^{5}}{-1}{11} & \cgm{7^{5}}{-1}{11}\\
\cgm{3^{5}}{\boxed{1}}{11} & \cgm{8^{5}}{-1}{11}\\
\cgm{4^{5}}{\boxed{1}}{11} & \cgm{9^{5}}{\boxed{1}}{11}\\
\cgm{5^{5}}{\boxed{1}}{11} & \cgm{10^{5}}{-1}{11}
\end{array}
\]
Raccogliendo i risultati dei test con la congruenza a $+1$, possiamo
scrivere l'insieme dei residui quadratici di $\mathbb{Z}_{11}^{*}$:
\[
a_{q}=\left\{ 1,\,3,\,4,\,5,\,9\right\} 
\]
\demo
\begin{rem}
Un modo più rapido per ottenere i residui quadratici consiste nel
sfruttare il fatto che essi saranno i quadrati dei primi $\frac{p-1}{2}$
elementi dell'insieme dei residui: 
\[
a_{q}=\left\{ 1^{2},\,\ldots,\,\left(\frac{p-1}{2}\right)^{2}\right\} 
\]
Riprendendo la consegna dell'Esempio \ref{exa:Trovare-i-residui},
i residui quadratici di $\mathbb{Z}_{11}^{*}$ si ottengono come:
\[
\begin{array}{lll}
\mod{1^{2}}{11}=1 & \mod{3^{2}}{11}=9 & \mod{5^{2}}{11}=3\\
\mod{2^{2}}{11}=4 & \mod{4^{2}}{11}=5
\end{array}\implies a_{q}=\left\{ 1,\,4,\,9,\,5,\,3\right\} 
\]
Otteniamo gli stessi residui quadratici trovati con i test, in ordine
diverso.
\end{rem}

\chapter{Cifrari elementari}

\section{Introduzione}

Facendo riferimento alla figura \ref{fig:Scenario-fondamentale- comunicazione},
possiamo individuare la caratteristica del sistema di cifratura modellizzato:
esso usa la stessa chiave $k$ per la cifratura e la decifratura del
messaggio; ammettiamo che essa sia consegnata al destinatario tramite
un canale sicuro.

Il testo in chiaro è definito all'interno di tutti i possibili messaggi
in chiaro componibili con l'alfabeto a disposizione ($p\in\mathscr{P}$),
il messaggio cifrato è anch'esso definito all'interno di un insieme
di ogni possibile messaggio cifrato componibile ($c\in\mathscr{C}$),
infine la chiave appartiene all'insieme di tutte le possibili chiavi
componibili ($k\in\mathscr{K}$).

Ogni chiave, all'interno dello spazio delle chiavi, è definita una
regola di cifratura ($\forall k\in\mathscr{K}\tc E_{k}\in\mathscr{E}$)
e anche una regola di decifratura ($\forall k\in\mathscr{K}\tc D_{k}\in\mathscr{D}$),
entrambe dipendenti da $k$.

Deve valere che la cifratura sia invertibile con la decifratura, ovvero
$\forall k\in\mathscr{K},\,p\in\mathscr{P},\,c\in\mathscr{C}\tc c=E_{k}\left(p\right)\land p=D_{k}\left(c\right)$;
in caso contrario la decifratura non sarebbe più possibile (collisioni
durante la cifratura di messaggi differenti).

\section{Cifrari a scorrimento e sostituzione}

\subsection{Cifrario di Cesare}

Il cifrario di Cesare utilizza uno scorrimento dell'alfabeto, la chiave
stessa è un simbolo dell'alfabeto:
\[
\mathscr{P}=\mathscr{C}=\mathscr{K}=\mathbb{Z}_{n}
\]
Si verifica nel caso dell'alfabeto inglese vale $n=26$; la funzione
di cifratura e di decifratura si indicano come:
\[
\begin{array}{c}
c=E_{k}\left(p\right)=\mod{\left(p+k\right)}n\\
p=D_{k}\left(c\right)=\mod{\left(c-k\right)}n
\end{array}
\]
Possiamo attaccare questo cifrario con una ricerca esaustiva dello
spazio delle chiavi, sapendo che $\left|\mathscr{K}\right|=n$, oppure
possiamo confrontare un testo in chiaro noto con un testo cifrato
per ottenere la chiave ($k=p-c$).

Chiamiamo questo tipo di cifrario \emph{mono-alfabetico}, ovvero ad
ogni carattere corrisponde un carattere.

\subsection{Cifrario affine}

Utilizza una combinazione lineare applicata al testo in chiaro; per
questo cifrario vale:
\[
\mathscr{P}=\mathscr{C}=\mathbb{Z}_{n},\,\mathscr{K}=k\left(a,\,b\right)
\]
La funzione di cifratura e di decifratura si indicano come:
\[
\begin{array}{c}
c=E_{k}\left(p\right)=\mod{\left(ap+b\right)}n\\
p=D_{k}\left(c\right)=\mod{\left(c-b\right)a^{-1}}n
\end{array}
\]
Bisogna prendere $a,\,b\in\mathbb{Z}_{n}$ e per la presenza dell'inversione
di $a$, è necessario che esso sia primo relativo a $n$ ($a\perp n$);
se così non fosse, si verificherebbero delle collisioni nella cifratura.

\subsection{Cifrario a sostituzione}

Ogni carattere è sostituito da un'altro, secondo una tabella arbitraria;
esso è la generalizzazione dei due precedenti cifrari (la chiave è
una permutazione dell'alfabeto), e vale
\[
\mathscr{P}=\mathscr{C}=\mathbb{Z}_{n},\,\left|\mathscr{K}\right|=n!
\]
La chiave è la tabella di sostituzione, e le funzioni di cifratura
e decifratura sono determinate dalle sostituzioni indicate nella tabella.

Possiamo attaccare questo cifrario (e tutti gli altri cifrari mono-alfabetici)
analizzando l'entropia dei singoli simboli dell'alfabeto: nel caso
di messaggi cifrati in linguaggio naturale, l'analisi delle frequenze
dei simboli può rivelare lettere molto usate.

Altri attacchi di questo tipo includono l'analisi della frequenza
dei digrammi e trigrammi (coppie e triple di lettere).

\subsection{Cifrario di Vigenère}

Questo cifrario lavora su blocchi di $h$ caratteri alla volta, e
per questo viene detto poli-alfabetico. In questo caso abbiamo:
\[
\mathscr{P}=\mathscr{C}=\mathscr{K}=\left(\mathbb{Z}_{n}\right)^{h}
\]
La chiave, il testo in chiaro e il testo cifrato saranno vettori di
$h$ elementi:
\[
k=\left(k_{1},\,\ldots,\,k_{h}\right),\,p=\left(p_{1},\,\ldots,\,p_{h}\right),\,c=\left(c_{1},\,\ldots,\,c_{h}\right)
\]
Le regole di cifratura e decifratura sono le stesse del cifrario di
Cesare, applicate su ciascun elemento del vettore $p$ o $c$:
\[
\begin{array}{c}
c=E_{k}\left(p\right)=\left(\mod{p_{1}+k_{1}}n,\,\ldots,\,\mod{p_{h}+k_{h}}n\right)\\
p=D_{k}\left(c\right)=\left(\mod{c_{1}-k_{1}}n,\,\ldots,\,\mod{c_{h}-k_{h}}n\right)
\end{array}
\]
In questo cifrario gli scorrimenti per ciascun elemento del blocco
dipendono dalla posizione al suo interno; la stessa lettera verrà
cifrata in modo diverso a seconda della sua posizione nel blocco;
l'analisi di frequenza si applica, suddividendo la frequenza di un
simbolo su $h$ possibili modi di cifrarlo (la difficoltà cresce all'aumentare
di $h$).

\section{Cifrario a permutazione}

Si tratta di un cifrario a blocco (lavora su $h$ simboli alla volta),
che permuta le posizioni dei caratteri in ogni blocco. Al contrario
del cifrario a sostituzione, la permutazione in ogni blocco è indipendente.
La chiave adottata è una permutazione delle posizioni all'interno
del blocco.
\begin{example}
\emph{Dato il cifrario a permutazione con blocchi di dimensione $n=6$
e permutazione $k=\left(3,\,5,\,1,\,6,\,4,\,2\right)$, cifrare il
messaggio $p=``\text{she sells sea shells}"$ (gli spazi tra le parole
non sono caratteri dell'alfabeto).}
\end{example}
$\checked$Identifichiamo i blocchi di $n=6$ caratteri; il primo
blocco da sinistra è $\mathbb{B}_{1}=``\text{shesel}"$, che possiamo
indicare come:
\[
p=\Bigl(\begin{array}{cccccc}
{\scriptscriptstyle 1} & {\scriptscriptstyle 2} & {\scriptscriptstyle 3} & {\scriptscriptstyle 4} & {\scriptscriptstyle 5} & {\scriptscriptstyle 6}\\
\text{s,} & \text{h}, & \text{e}, & \text{s}, & \text{e}, & \text{l}
\end{array}\Bigr)
\]
A questo punto applichiamo la permutazione $k$, che sposta i simboli
del blocco nella seguente configurazione:
\[
c=\Bigl(\begin{array}{cccccc}
{\scriptscriptstyle 3} & {\scriptscriptstyle 5} & {\scriptscriptstyle 1} & {\scriptscriptstyle 6} & {\scriptscriptstyle 4} & {\scriptscriptstyle 2}\\
\text{e,} & \text{e}, & \text{s}, & \text{l}, & \text{s}, & \text{h}
\end{array}\Bigr)
\]
\demo

Questo cifrario risulta poli-alfabetico, e ogni blocco di lunghezza
$n$ può essere cifrato in $n!$ modi differenti.

\section{Proprietà fondamentali dei cifrari a blocchi}

In un cifrario a blocco di lunghezza $n$, si prende un messaggio
in chiaro e a partire da esso si ottiene un messaggio cifrato, entrambi
della stessa lunghezza ($\left|p\right|=\left|c\right|=n$).

Nell'articolo\footnote{\emph{``Communication Theory of Secrecy Systems'' }(1949), Bell
System Technical Journal} sulla crittografia pubblicato da Shannon, egli espone due proprietà
fondamentali che ogni sistema crittografico dovrebbe avere:
\begin{description}
\item [{\noun{Diffusione}}] Si ha diffusione perfetta se, cambiando 1 bit
del blocco in chiaro, tutti i bit del blocco cifrato corrispondente
cambiano in maniera apparentemente casuale, con probabilità $1/2$.
La perfetta diffusione vale anche nel senso opposto: cambiando 1 bit
del blocco cifrato, tutti i bit del blocco in chiaro corrispondente
cambiano con probabilità $1/2$.
\item [{\noun{Confusione}}] La chiave deve avere effetto su tutti i bit
del blocco cifrato: a parità di blocco in chiaro, se cambia 1 bit
della chiave, tutti i bit del blocco cifrato cambieranno, con probabilità
$1/2$.
\end{description}
Queste due proprietà si riassumono nella seguente affermazione:
\begin{prop}
\label{prop:Propriet=0000E0-fondamentali-cifrari-Shannon}Non solo
ogni bit della chiave ha effetto su \uline{tutti} i bit del blocco
cifrato, ma anche tutti i bit della chiave hanno effetto su \uline{ogni}
bit del blocco cifrato.
\end{prop}

\chapter{Cifrario DES}

Testo qui

\chapter*{Esercizi}

\section*{Equazioni congruenziali}
\begin{xca}
Risolvere la seguente equazione congruenziale:\marginpar{$\blacktriangleright$ \emph{Esercizio: equazione congruenziale, modulo
composto}}
\[
\cgm{28x}{16}{412}
\]
\rule[0.5ex]{0.9\textwidth}{0.1pt}
\end{xca}
\begin{sol}
Procediamo calcolando $\mcd{28}{412}=4$; allora possiamo dividere
per 4 tutti i termini dell'equazione, ottenendo
\[
\cgm{7x}4{103}
\]
L'equazione originale avrà 4 soluzioni, e la prima si ricava dall'equazione
ridotta appena trovata:
\[
\cgm{x_{0}}{4\cdot7^{-1}}{103}
\]
Per calcolare l'inverso di 7 modulo 103 possiamo usare il Teorema
\ref{thm:Teorema-piccolo-Fermat} oppure l'algoritmo (\ref{eq:Algoritmo-Euclide-esteso}).\bigskip{}

\noun{Teorema piccolo di Fermat}\\
Il teorema afferma che, in questo caso, vale
\[
\cgm{7^{-1}}{7^{101}}{103}
\]
dato che 103 è primo; adesso effettuiamo l'operazione di $\mod{7^{101}}{103=59}$
(possiamo usare l'algoritmo descritto ne \secref{Square-=000026-multiply}),
da cui segue che
\[
\cgm{7^{-1}}{59}{103}
\]

\noun{Algoritmo di Euclide Esteso}\\
Usiamo l'algoritmo per ottenere che $7\perp103$ e in tal caso anche
$7^{-1}$; cominciamo a costruire la sequenza (\ref{eq:Algoritmo-Euclide}):
\[
\begin{array}{cc}
103=14\cdot7+5 & q_{1}=14\\
7=1\cdot5+2 & q_{2}=1\\
5=2\cdot2+\boxed{1} & q_{3}=2\\
2=2\cdot1+0 & q_{4}=1
\end{array}
\]
Otteniamo che $\mcd 7{103}=1$, e per quanto riguarda l'inverso costruiamo
la sequenza (\ref{eq:Algoritmo-Euclide-esteso}):
\[
\begin{array}{c}
x_{0}=0\\
x_{1}=1\\
x_{2}=-q_{1}x_{1}+x_{0}=-14\\
x_{3}=-q_{2}x_{2}+x_{1}=15\\
x_{4}=-q_{3}x_{3}+x_{2}=\boxed{-44}
\end{array}
\]
Segue che $\mod{-44}{103}=59=7^{-1}$.

\bigskip{}

Ora che abbiamo l'inverso di 7 in modulo 103, siamo in grado di scrivere
la soluzione dell'equazione ridotta:
\[
\begin{array}{c}
\cgm{x_{0}}{4\cdot59}{103}\\
\cgm{x_{0}}{30}{103}
\end{array}
\]
Le soluzioni successive saranno altre tre, a 103 di distanza da $x_{0}$,
esse inoltre saranno in modulo 412:
\[
X=\left\{ 30,\,133,\,236,\,339\right\} \mod{}{412}
\]
\demo
\end{sol}
\begin{xca}
Trovare\marginpar{$\blacktriangleright$ \emph{Esercizio: sistema di 2 congruenze}}
la congruenza equivalente al seguente sistema di congruenze:
\[
\begin{cases}
\cgm x5{11}\\
\cgm x2{20}
\end{cases}
\]
\rule[0.5ex]{0.9\textwidth}{0.1pt}
\end{xca}
\begin{sol}
Esisterà una sola congruenza equivalente, per il Teorema \ref{thm:Teorema-cinese-del-resto},
infatti vale $11\perp20$; per riassumere le due congruenze in una
sola, cerchiamo un valore $x$ della successione $5+k\cdot11$ che
sia anche congruente a 2 in modulo 20:
\[
x=\cgm{5+k\cdot11}2{20}
\]
Questo sarà vero per un valore di $k$ pari a
\[
\begin{array}{c}
\cgm{k\cdot11}{2-5}{20}\\
\cgm k{-3\cdot11^{-1}}{20}
\end{array}
\]
Troviamo l'inverso di 11 in modulo 20 usando il Teorema \ref{thm:Teorema-Eulero}:
\[
\cgm{11^{-1}}{11^{\varphi\left(20\right)-1}}{20}
\]
sapendo che la funzione toziente di 20 vale $\varphi\left(20\right)=\left(2^{2}-2^{1}\right)\left(5^{1}-5^{0}\right)=2\cdot4=8$,
e che $\mod{11^{8-1}}{20}=11$, abbiamo la seguente congruenza per
$k$:
\[
\begin{array}{c}
\cgm k{-33}{20}\\
\cgm k7{20}
\end{array}
\]
Ritornando alla congruenza per $x$, si ottiene dalla precedente (con
$k=7$):
\[
\begin{array}{c}
x=\cgm{5+77}2{20\cdot11}\\
\cgm x{82}{220}
\end{array}
\]
dove abbiamo usato il Teorema \ref{thm:Teorema-cinese-del-resto}
per comporre la congruenza in modulo 220.\demo
\end{sol}
\begin{xca}
Trovare\marginpar{$\blacktriangleright$ \emph{Esercizio: sistema di 3 congruenze}}
il valore della variabile $x$, che compare nel sistema di congruenze:
\[
\begin{cases}
\cgm x1{10}\\
\cgm x2{11}\\
\cgm x03
\end{cases}
\]
\rule[0.5ex]{0.9\textwidth}{0.1pt}
\end{xca}
\begin{sol}
Mettiamo assieme la prima congruenza con la seconda, ottenendo:
\[
x=\cgm{1+k\cdot10}2{11}
\]
Risolviamo la precedente rispetto a $k$:
\[
\cgm{k\cdot10}1{11}
\]
Notando che $100=9\cdot11+1\implies\mod{100}{11}=1$ possiamo affermare
subito che $k=10$; per il Teorema \ref{thm:Teorema-cinese-del-resto}
scriviamo:
\[
\cgm x{101}{110}
\]
Unendo quanto ottenuto con la terza congruenza del sistema, si ha:
\[
x=\cgm{101+k\cdot110}03
\]
Effettuando l'operazione di modulo 3 sui termini dell'equazione, avremo:
\[
x=\cgm{2+h\cdot2}03
\]
Risolviamo la precedente rispetto ad $h$:
\[
\begin{array}{c}
\cgm{2\cdot h}{-2}3\\
\cgm h{1\cdot2^{-1}}3
\end{array}
\]
Osserviamo che l'inverso di 2 in $\mathbb{Z}_{3}$ è proprio 2, infatti
$2\cdot2=\mod 43=1$; allora $h$ è congruente a 2 in modulo 3, e
sostituendo nella congruenza di $x$ otteniamo:
\[
\begin{array}{c}
\cgm x{101+220}{110\cdot3}\\
\cgm x{321}{330}
\end{array}
\]
Abbiamo trovato che $x$ deve valere $321+k\cdot330$ per generare
le tre congruenze esaminate.\demo
\end{sol}

\section*{Elementi primitivi}
\begin{xca}
Quanti elementi primitivi ha l'insieme $\mathbb{Z}_{31}^{*}$, e quali
sono?\marginpar{$\blacktriangleright$ \emph{Esercizio: elementi primitivi di un insieme
dei residui}}

\rule[0.5ex]{0.9\textwidth}{0.1pt}
\end{xca}
\begin{sol}
Gli elementi primitivi sono in numero $\varphi\left(31-1\right)=\varphi\left(30\right)=\left(2^{1}-2^{0}\right)\left(3^{1}-3^{0}\right)\left(5^{1}-5^{0}\right)=1\cdot2\cdot4=8$
(applichiamo una delle formule \vpageref{eqn:Toziente} per calcolare
il toziente $\varphi\left(\circ\right)$).

Per capire quali siano gli elementi primitivi, usiamo il test (\ref{eq:Test-primitivit=0000E0})
con i quozienti $q_{i}=\left\{ 2,\,3,\,5\right\} $, per ciascun elemento
di $\mathbb{Z}_{31}^{*}$ (da 1 a 30); facendo le prove col test rispetto
ai tre quozienti, si ottengono i seguenti elementi primitivi:
\[
\alpha=\left\{ 3,\,11,\,12,\,13,\,\ldots\right\} 
\]
\demo
\end{sol}
\begin{xca}
Trovare gli elementi primitivi dell'insieme $\mathbb{Z}_{13}^{*}$\marginpar{$\blacktriangleright$ \emph{Esercizio: elementi primitivi di un insieme
dei residui}}

\rule[0.5ex]{0.9\textwidth}{0.1pt}
\end{xca}
\begin{sol}
Usiamo un secondo metodo, a partire da un elemento sicuramente primitivo
$\alpha\in\mathbb{Z}_{13}^{*}$; proviamo con 2, sottoponendolo al
test (\ref{eq:Test-primitivit=0000E0}):
\[
\cgm{2^{6}}{-1}{13},\quad\cgm{2^{4}}3{13}
\]
Allora $\alpha=2$ è un elemento primitivo rispetto a $p=13$; possiamo
elevare $\alpha$ a tutte le potenze, per ottenere tutti gli elementi
dell'insieme. Tuttavia solo le potenze positive pari restituiranno
un altro elemento primitivo rispetto a $p$ che è un quadrato:
\[
\begin{array}{lll}
\cgm{\alpha^{1}}2{13} & \cgm{\alpha^{5}}6{13} & \cgm{\alpha^{9}}5{13}\\
\cgm{\alpha^{2}}{\boxed{4}}{13} & \cgm{\alpha^{6}}{\boxed{12}}{13} & \cgm{\alpha^{10}}{\boxed{10}}{13}\\
\cgm{\alpha^{3}}8{13} & \cgm{\alpha^{7}}{11}{13} & \cgm{\alpha^{11}}7{13}\\
\cgm{\alpha^{4}}{\boxed{3}}{13} & \cgm{\alpha^{8}}{\boxed{9}}{13} & \cgm{\alpha^{12}}{\boxed{1}}{13}
\end{array}
\]
Le radici primitive in $\mathbb{Z}_{13}^{*}$ sono:
\[
a_{q}=\left\{ 1,\,3,\,4,\,9,\,10,\,12\right\} 
\]
Si noti che ci troviamo nel caso $\cgm p14$, per cui se non esiste
$\sqrt{a}$ nemmeno $\sqrt{-a}$ è definita rispetto a $p$.\demo
\end{sol}

\part{Protocolli e sistemi per la comunicazione sicura}

\appendix

\chapter{Introduzione alla crittografia}

\subsection*{Cenni storici}

Il termine crittografia deriva dal greco $\kappa\rho\nu\pi\tau\acute{o}\zeta$
(krypt$\acute{\text{o}}$s - segreto) e $\gamma\rho\alpha\varphi\acute{\eta}$
(grafi - scrittura); tra gli esempi di crittografia dal passato il
più famoso è il cifrario di Cesare: si tratta di un cifrario a scorrimento
ciclico, che consisteva nello scrivere le lettere dell'alfabeto su
due anelli per poi ruotarne uno rispetto all'altro di $k=+3$ posizioni;
in questo modo si ottiene $A\rightarrow D,\,B\rightarrow E,\,\ldots Z\rightarrow C$.

Non si trattava di un cifrario robusto, ma veniva usato quando gli
avversari dell'Impero Romano erano i Galli: si rivelò un metodo più
che sufficiente.

\subsection*{Comunicazione sicura}

In generale una comunicazione sicura tra due parti si svolge nel modo
seguente: sia $A$ il mittente del messaggio, $B$ il destinatario,
ed $E$ un intruso che abbia accesso al canale di comunicazione. L'intruso
può essere \emph{passivo} (intercetta i messaggi senza modificarne
il flusso) oppure \emph{attivo} (modifica il contenuto dei messaggi).

\begin{figure}[!h]
\begin{centering}
\includegraphics[scale=1.3]{\string"Illustrazioni/A_1 Scenario fondamentale di comunicazione\string".pdf}
\par\end{centering}
\caption{Scenario fondamentale di comunicazione}
\label{fig:Scenario-fondamentale- comunicazione}
\end{figure}

$\boldsymbol{A}$ invia un \emph{plaintext} $m$ (testo in chiaro),
lo codifica usando una funzione di cifratura (un algoritmo crittografico)
che prende in ingresso anche la sua chiave $k_{{\scriptscriptstyle \text{A}}}$
e ottiene un \emph{ciphertext $c$} (messaggio cifrato); il messaggio
$c$ giunge a $\boldsymbol{B}$, il quale usa una funzione di de-cifratura
\---- tramite la sua chiave $k_{{\scriptscriptstyle \text{B}}}$,
che è associata in qualche modo alla chiave $k_{{\scriptscriptstyle \text{A}}}$
\---- per ottenere nuovamente il \emph{plaintext} $m$ inviato da
\textbf{$\boldsymbol{A}$}.

$\boldsymbol{E}$ potrebbe avere le seguenti intenzioni malevole rispetto
alla comunicazione tra $\boldsymbol{A}$ e $\boldsymbol{B}$:
\begin{itemize}
\item leggere il messaggio e comprenderne il contenuto;
\item ottenere la chiave;
\item corrompere il contenuto del messaggio;
\item impersonare $A$ senza che $B$ se ne accorga.
\end{itemize}
L'intruso può mettere in atto i seguenti tipi di attacchi sull'algoritmo
di cifratura usato nella comunicazione:
\begin{itemize}
\item \noun{ciphertext-only}: avendo a disposizione il testo cifrato, si
cerca di ricavarne delle informazioni (attacco più comune);
\item \noun{known plaintext}: avendo a disposizione una coppia di testo
cifrato e testo in chiaro corrispondente, si confrontano i due cercando
di ottenere informazioni sulla chiave;
\item \noun{chosen plaintext}: avendo a disposizione la stessa implementazione
dell'algoritmo utilizzato per cifrare il messaggio, si scelgono dei
testi in chiaro da cifrare e si osservano i testi cifrati in uscita,
per cercare di ricavare informazioni sull'implementazione;
\item \noun{chosen ciphertext}: avendo a disposizione la stessa implementazione
dell'algoritmo utilizzato per decifrare il messaggio, si scelgono
dei testi cifrati da decifrare e si osservano i testi in chiaro in
uscita, per cercare di ricavare informazioni sull'implementazione.
\end{itemize}

\subsection*{Sicurezza e segretezza}

Giulio Cesare basava la sicurezza del proprio algoritmo di cifratura
sul fatto che i possibili avversari non ne conoscessero il funzionamento;
il crittografo olandese Auguste Kerckhoffs, enunciò ne \emph{`La cryptographie
militaire'} (1883) il principio di Kerchoffs:\marginpar{\rule[0.5ex]{3cm}{1pt}\textbf{\footnotesize{}}\protect \\
\textbf{\footnotesize{}Principio di Kerchoffs}{\footnotesize{}\index{Kerchoffs, principio di@{\footnotesize{}Kerchoffs, principio di}}\label{thm:Principio-di-Kerchoffs}}}[0.7cm]
\begin{center}
\begin{minipage}[t]{0.8\textwidth}%
\begin{center}
\emph{La sicurezza di un sistema di cifratura è basata sulla segretezza
della chiave (assumere sempre che il nemico conosca l'algoritmo di
cifratura)}
\par\end{center}%
\end{minipage}
\par\end{center}

Da questa considerazione segue che la chiave utilizzata deve essere
lunga, complessa, e in generale essere costruita per evitare che sia
possibile indovinarla.

Claude Elwood Shannon, che scrisse cinque articoli che cambiarono
la storia della comunicazione dell'informazione, tra cui un articolo
sulla crittografia\footnote{\emph{``Communication Theory of Secrecy Systems'' }(1949), Bell
System Technical Journal}, espresse lo stesso principio in maniera molto incisiva con le parole
``Il nemico conosce il sistema'' (frase nota come massima di Shannon).

È interessante notare come si è passati dal fondare la sicurezza del
sistema sulla segretezza dell'algoritmo alla segretezza della chiave;
il passo successivo fu il sistema a \emph{chiave pubblica}: gli algoritmi
usati sono noti e accessibili a tutti, e una chiave del mittente (quella
pubblica) è resa nota a tutti; tramite la chiave pubblica è possibile
cifrare i messaggi, tuttavia la chiave per decifrare, associata alla
chiave pubblica, è mantenuta riservata (si parla di\emph{ chiave privata}).

Fondamentale è il fatto che, non ostante esista una regola (formula
o algoritmo) che permetta di associare la chiave pubblica a quella
privata, per un intruso qualunque è impossibile, dal punto di vista
computazionale, risalire alla chiave privata attraverso quella pubblica.
Solo il mittente che possiede la chiave privata è in grado di computare
questa associazione, poiché egli deve aver ricavato la chiave pubblica
a partire da quella privata (l'operazione inversa risulta molto più
difficile).

\subsection*{Algoritmi noti}

Gli algoritmi a chiave simmetrica hanno una coppia di chiavi, per
cifratura e de-cifratura, che sono entrambe segrete: DES, AES; si
pone il problema di scambiare col destinatario la chiave di de-cifratura,
utilizzando un canale sicuro.

Con i sistemi di cifratura a chiave pubblica questo problema non si
pone, tuttavia si pone il nuovo problema dell'autenticità delle chiavi
pubbliche in circolazione; è stato introdotto il meccanismo dei certificati,
da associare alle chiavi pubbliche, per garantire la loro provenienza
e affidabilità.

\subsection*{Numeri interi grandi}

Lavoreremo prevalentemente con numeri interi (positivi e negativi)
di elevato ordine di grandezza; ecco un esempio per effettuare un
calcolo approssimato.
\begin{example}
\emph{\label{ex:grandi-interi-approssimati}Calcolare in modo approssimato
il valore di $2^{35}$.}

\emph{$\checked$}Sfruttando le proprietà delle potenze e la costante
informatica $2^{10}\sim1000=10^{3}$, possiamo ragionare nel modo
seguente:
\[
2^{35}=2^{30}\cdot2^{5}=\left(2^{10}\right)^{3}\cdot32\simeq\left(10^{3}\right)^{3}\cdot32=\boxed{32\times10^{9}}
\]
\demo
\end{example}
Trattare interi grandi è importante nell'ambito degli algoritmi di
cifratura: prendendo l'algoritmo a chiave simmetrica DES come esempio,
è ragionevole pensare che una chiave di 56 bit non sia sufficientemente
sicura; usando le considerazioni fatte nell'Esempio \ref{ex:grandi-interi-approssimati}
otteniamo che $2^{56}\simeq10^{16}$, ed essendo in possesso di una
macchina in grado di ottenere una chiave in 1$ns$, allora sarebbero
necessari 27 mesi per ottenere questa chiave; ovviamente si può ridurre
questo tempo aumentando il numero di macchine impiegate.

Al giorno d'oggi sono considerate sicure chiavi a 265 bit ($\sim10^{77}$):
per analizzare in modo esaustivo un simile spazio delle chiavi sarebbero
necessari $10^{60}$ anni, nelle condizioni descritte in precedenza!

\renewcommand{\chaptername}{}\printindex
\end{document}
